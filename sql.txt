1. 
SELECT id, created_at, offer_id, comment_text
FROM comments
WHERE id=1;

2. 
SELECT id, to_char(created_at, 'DD.MM.YYYY'), user_id, offer_type, title, price, picture
FROM offers
WHERE created_at >= '2021-10-01'::date and created_at < '2021-10-31'::date
ORDER BY  created_at DESC;

3. 
SELECT users.id, users.email, users.created_at, format('%s_%s', users.first_name, users.last_name)
FROM users
JOIN offers ON users.id=offers.user_id
GROUP BY users.id, users.email, users.created_at, users.first_name, users.last_name
HAVING COUNT(*)=0
ORDER BY users.created_at;

4. 
SELECT offers.id, users.first_name, users.last_name, offers.title, offers.price
FROM offers
JOIN users ON offers.user_id=user.id
ORDER BY offers.price DESC
LIMIT 3;

5.
SELECT categories.title, categories.id, categories.slug, COUNT(*) AS offer_amount 
FROM categories
JOIN category_offer ON category_offer.categoty_id=categories.id
JOIN offers ON offers.id=category_offer.category_id
GROUP BY categories.title, categories.id, categories.slug
HAVING COUNT(*)>0;

1*.
SELECT categories.title AS category_name, offers.id, offers.created_at, offers.user_id, offers.title, offers.price
FROM offers
JOIN category_offer ON category_offer.offer_id=offers.id
JOIN categories ON categories.id=category_offer.category_id
GROUP BY category_name, offers.id, offers.created_at, offers.user_id, offers.title, offers.price
WHERE categories.title='Дом'
LIMIT 4,4;

2*.
SELECT offers.id, offers.title, offers.user_id, offers.offer_type, offers.price, string_agg(categories.name,',') AS categories,
	CASE WHEN categories.offer_type THEN 'Куплю' ELSE 'Продам'
FROM offers
JOIN category_offer ON category_offer.offer_id=offers.id
JOIN categories ON categories.id=category_offer.category_id
ORDER BY offers.price DESC

3*.
SELECT users.id, users.first_name, users.last_name, users.email,
	(SELECT COUNT(*) FROM offers WHERE users.id=offers.user_id GROUP BY offers.user_id) AS
	(SELECT COUNT(*) FROM comments WHERE users.id=comments.user_id GROUP BY comments.user_id) AS
FROM users
ORDER BY offer_amount DESC;

4*.
SELECT offers.id, offers.offer_type, categories.title, users.first_name, users.last_name, offers.title, substring(offers.full_text, from 1 to 30) || '...', offers.price
JOIN category_offer ON offers.id=category_offer.offer_id
JOIN categories ON categories.id=category_offer.category_id
JOIN users ON users.id=offers.user_id
GROUP BY offers.id, offers.offer_type, categories.title, users.first_name, users.last_name, offers.title, offers.full_text, offers.price
WHERE offers.price<50000 and offers.offer_type='buy' and categories='Животное' and offers.title LIKE '%кролик%' and offers.title LIKE '%гараж%';












